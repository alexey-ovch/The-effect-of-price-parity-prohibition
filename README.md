# Эффект запрета паритета цен на онлайн-платформах

Эконометрическое исследование влияния законодательного запрета на политику паритета цен на ценообразование отелей на примере французского закона 2015 года.

Этот проект оценивает причинно-следственный эффект от закона французского президента Э. Макрона (2015 г.), запретившего онлайн-платформам устанавливать требования паритета цен. До принятия закона платформы вроде Booking.com и Expedia требовали, чтобы отели не предлагали лучшие условия (более низкие цены, лучшие условия отмены) на альтернативных каналах продаж.

Исследование использует **два методологических подхода**:
1. Разность разностей (Difference-in-Differences, DiD)
2. Синтетический контроль (Synthetic Control Method)

## Дизайн исследования
Анализ основан на сравнении двух географических единиц:
- **Корсика** (Франция) — **группа воздействия (treatment group)**: закон распространялся на французские отели
- **Сардиния** (Италия) — **контрольная группа (control group)**: закон не распространялся, служит контрольной группой
Такая структура позволяет использовать естественный эксперимент и получить несмещенную оценку причинного эффекта.

### Временной период
- **До воздействия**: апрель–июль 2015 г. (до объявления закона)
- **Воздействие**: объявление закона (32-я неделя), принятие закона (28-я неделя)
- **После воздействия**: август–октябрь 2015 г.

## Методология
### Подход 1: Разность разностей (DiD)
Метод DiD оценивает эффект как разницу в изменениях цен между группой воздействия и контрольной группой.

#### Спецификация
log(price) = β₀ + β₁·Treated + β₂·Post + β₃·(Treated × Post) + контрольные переменные + ε,
где:
- **Treated** = 1 для Корсики, 0 для Сардинии
- **Post** = 1 после введения закона
- **Treated × Post** — эффект запрета паритета цен (основной коэффициент интереса)

#### Модели
Проект оценивает 5 моделей с постепенным добавлением переменных:

| Модель | Описание | Основной результат |
|--------|---------|---------------------|
| **Модель 1** | Простая DiD без контрольных переменных | Эффект = -2.367%*** |
| **Модель 2** | Добавлены переменные сезонности (google_src, town_avail) | Эффект = -12.680%*** |
| **Модель 3** | Тройное взаимодействие с типом отеля (сетевые/независимые) | Эффект = -13.148%*** |
| **Модель 4** | Тройное взаимодействие с звездностью отеля | Эффект = -11.405%*** |
| **Модель 5** | Тройное взаимодействие с размером отеля | Эффект = -13.592%*** |

#### Ключевые результаты DiD
- **Основной эффект**: Запрет паритета цен **снизил цены на 11–13.6%** на Корсике относительно Сардинии
- **Все модели показывают статистически значимый результат** (p < 0.001)
- **Гетерогенный эффект**: Более звездные отели испытали больший эффект (взаимодействие Treated:Post:stars = -1.192***)

#### Контрольные переменные и их интерпретация
- **google_src** (поисковые запросы): отражает сезонность туристических потоков. Положительный коэффициент (+0.61***) — более высокий спрос связан с ростом цен
- **town_avail** (доступность отелей в городе): отрицательный коэффициент (-43.7***) — больше конкурентов означает более низкие цены
- **Corsica_bdays, Sardinia_bdays** (дни до бронирования): отрицательные коэффициенты (-0.5***) — позднее бронирование означает более низкие цены
- **dchain, stars, hot_size** (характеристики отеля): контролируют разнородность отельной базы

### Подход 2: Синтетический контроль
Синтетический контроль создает **взвешенную комбинацию других сицилийских регионов**, которая наилучшим образом воспроизводит тренд Корсики до воздействия.

#### Процедура
1. **Выбор предикторов**: средние значения характеристик за период до воздействия (недели 25–32)
   - bdays, stars, hot_size, capacity, punteggio (рейтинг), date_start_booking, google_src
2. **Оптимизация весов**: поиск весов, минимизирующих различия между Корсикой и синтетической Корсикой на периоде до воздействия
3. **Оценка эффекта**: разница между фактическими и синтетическими ценами после воздействия

#### Ключевые результаты синтетического контроля
- **Предвоздействие**: синтетическая Корсика практически совпадает с реальной (хороший баланс)
- **Краткосрочный период**: незначительный разрыв (1–7 недель после введения)
- **8+ недель после воздействия**: наблюдается заметное снижение реальных цен относительно синтетических
- **Веса композиции**: регионы 6, 12, 9 оказывают наибольшее влияние на синтетическую Корсику

#### Валидация метода
**Плацебо-тест во времени**: применение метода к периоду без воздействия (неделя 28 вместо 32) показывает **отсутствие значимых различий**, подтверждая корректность модели.
**Плацебо-тест в пространстве**: при применении метода к контрольным регионам разрывы остаются близкими к нулю до воздействия, что подтверждает отсутствие структурных сдвигов.
**MSPE ratio**: для Корсики разница квадратов отклонений после/до воздействия значительна, в то время как для контрольных регионов — минимальна, что подтверждает эффект.

## Структура кода
Проект разделен на две основные части:
### Часть 1: Разность разностей (`model_1` — `model_5`)
Загрузка и подготовка данных
filtered_data <- dataset %>% filter(sample_mac_sr == 1)

Создание dummy-переменных
filtered_data <- filtered_data %>% mutate(
is_corsica = ifelse(region == 1, 1, 0),
Corsica_bdays = is_corsica * bdays,
Sardinia_bdays = (1 - is_corsica) * bdays
)

Регрессии методом DiD
model_1 <- lm(lprice100 ~ TreatedPost, data = filtered_data)
model_2 <- lm(lprice100 ~ TreatedPost + Corsica_bdays + Sardinia_bdays + google_src + town_avail, data = filtered_data)
model_3 <- lm(lprice100 ~ TreatedPostdchain + ..., data = filtered_data)
model_4 <- lm(lprice100 ~ TreatedPoststars + ..., data = filtered_data)
model_5 <- lm(lprice100 ~ TreatedPosthot_size + ..., data = filtered_data)

Представление результатов
stargazer(model_1, model_2, model_3, model_4, model_5, type = "text")

### Часть 2: Синтетический контроль
library(tidysynth)
Основная процедура синтетического контроля
out1 <- data %>%
synthetic_control(outcome = lprice100, time = week_src, unit = classification,
i_unit = 1, i_time = 32, generate_placebos = TRUE) %>%
generate_predictor(time_window = 25:32, bdays = mean(bdays, na.rm = TRUE), ...) %>%
generate_weights(optimization_window = 25:32, ...) %>%
generate_control()

Визуализация результатов
out1%>% plot_trends() # Тренды реальной и синтетической Корсики
out1%>% plot_differences() # Разрыв между ними
out1%>% plot_mspe_ratio() # Качество подгонки

Плацебо-тесты
out1%>% plot_placebos() # В пространстве
out_placebo %>% plot_trends() # Во времени

## Используемые пакеты R
library(dplyr) # Манипуляция данными
library(stargazer) # Форматирование результатов регрессий
library(haven) # Загрузка Stata файлов
library(tidysynth) # Синтетический контроль
library(devtools) # Установка пакетов с GitHub

## Ключевые выводы
1. **Эффект запрета паритета цен значимый и устойчивый**: Снижение цен на 11–13.6% подтверждено обоими методами (DiD и синтетический контроль)
2. **Гетерогенный эффект по характеристикам отелей**:
   - Более звездные отели испытали больший эффект
   - Сетевые отели начали реагировать до официального введения закона
   - Размер отеля имеет маргинальное значение
3. **Важность контрольных переменных**: Добавление переменных сезонности и характеристик отелей изменило оценку эффекта с -2.4% до -12.7%, подчеркивая необходимость правильной спецификации модели
4. **Политические последствия**: Запрет паритета цен привел к усилению конкуренции и снижению цен для потребителей, что соответствует целям антимонопольного регулирования
5. **Экономическая важность**: Результаты иллюстрируют потенциал регуляторных мер по ограничению власти онлайн-платформ в экономике совместного потребления

## Исходные данные
Проект использует два датасета:
- `data_mac_sr.dta` — данные для методологии разности разностей (short-run)
- `data_mac_synth.dta` — данные для синтетического контроля

Проект основан на работе:
> Mantovani, A., Piga, C. A., & Reggiani, C. (2021). "Online platform price parity clauses: Evidence from the EU Booking.com case." *European Economic Review*, 131.

Исследование является частью более широкого анализа:
- Роль онлайн-платформ в экономике совместного потребления
- Антимонопольное регулирование многосторонних платформ
- Сравнительный анализ подходов к регулированию в разных странах

